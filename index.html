<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#131921">
    <title>FlexRunner</title>
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.PNG">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon.png">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon.PNG">

```
<style>
    :root {
        --safe-top: env(safe-area-inset-top, 59px);
        --safe-bottom: env(safe-area-inset-bottom, 34px);
        --amazon-orange: #FF9900;
        --amazon-orange-dark: #E68A00;
        --amazon-squid: #232F3E;
        --amazon-dark: #131921;
        --amazon-light-blue: #00A8E1;
        --white: #FFFFFF;
        --gray-400: #888888;
        --gray-500: #666666;
        --success: #00A854;
        --error: #D13212;
    }

    * {
        margin: 0; padding: 0; box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
    }

    html {
        height: 100%;
        overflow: hidden;
    }

    body {
        height: 100%;
        overflow: hidden;
        touch-action: none;
        position: fixed;
        inset: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
        background: var(--amazon-dark);
        color: var(--white);
    }

    .app, .delivery-app {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        display: flex;
        flex-direction: column;
        padding-top: var(--safe-top);
        padding-bottom: var(--safe-bottom);
        overflow: hidden;
    }

    /* Header - Compact */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 12px;
        background: var(--amazon-squid);
        border-bottom: 3px solid var(--amazon-orange);
    }

    .logo { font-size: 20px; font-weight: 700; }
    .logo span { color: var(--amazon-orange); }

    .zone-counts { display: flex; gap: 14px; }

    .zone-count {
        display: flex;
        flex-direction: column;
        align-items: center;
        font-size: 9px;
        font-weight: 700;
        color: var(--gray-400);
        text-transform: uppercase;
    }

    .zone-count-num {
        font-size: 18px;
        font-weight: 800;
        color: var(--white);
    }

    /* Number Display - Minimal */
    .number-display {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 8px 12px;
        background: var(--amazon-squid);
    }

    .current-number {
        font-size: 64px;
        font-weight: 800;
        letter-spacing: -2px;
        line-height: 1;
        color: var(--white);
        font-variant-numeric: tabular-nums;
    }

    .current-number.empty { color: var(--gray-500); }
    .current-number.exists { color: var(--amazon-orange); }

    .number-hint {
        font-size: 13px;
        font-weight: 600;
        color: var(--gray-400);
        margin-top: 2px;
    }

    .number-hint.exists { color: var(--amazon-orange); }

    /* Numpad - LARGE */
    .numpad {
        flex: 1;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(4, 1fr);
        gap: 6px;
        padding: 6px 8px;
    }

    .numpad-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        font-weight: 600;
        border: none;
        border-radius: 12px;
        background: var(--amazon-squid);
        color: var(--white);
    }

    .numpad-btn:active {
        transform: scale(0.96);
        background: #3a4553;
    }

    .numpad-btn.clear {
        background: var(--error);
        font-size: 36px;
        font-weight: 800;
    }

    .numpad-btn.backspace {
        background: var(--gray-500);
        font-size: 36px;
    }

    /* Zone Buttons */
    .zone-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
        padding: 6px 8px;
    }

    .zone-btn {
        padding: 16px 6px;
        border: 3px solid var(--amazon-orange);
        border-radius: 12px;
        background: transparent;
        color: var(--amazon-orange);
        font-size: 18px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .zone-btn:active {
        transform: scale(0.96);
        background: var(--amazon-orange);
        color: var(--amazon-dark);
    }

    .zone-btn.disabled {
        opacity: 0.25;
        pointer-events: none;
    }

    /* Bottom CTA */
    .bottom-cta { padding: 6px 8px; }

    .cta-btn {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 12px;
        background: linear-gradient(180deg, var(--amazon-orange) 0%, var(--amazon-orange-dark) 100%);
        color: var(--amazon-dark);
        font-size: 17px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .cta-btn:active { transform: scale(0.98); }
    .cta-btn:disabled { opacity: 0.35; }

    /* ===== DELIVERY MODE ===== */
    .delivery-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 12px;
        background: var(--amazon-squid);
        border-bottom: 3px solid var(--success);
    }

    .delivery-title { font-size: 20px; font-weight: 700; }
    .delivery-title span { color: var(--success); }

    .back-btn {
        padding: 8px 14px;
        border: none;
        border-radius: 8px;
        background: var(--gray-500);
        color: var(--white);
        font-size: 14px;
        font-weight: 700;
    }

    /* Stats - Compact */
    .delivery-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        padding: 6px 8px;
    }

    .stat-box {
        padding: 12px;
        border-radius: 10px;
        text-align: center;
    }

    .stat-box.delivered { background: linear-gradient(145deg, #00875A, var(--success)); }
    .stat-box.remaining { background: linear-gradient(145deg, #0066AA, var(--amazon-light-blue)); }

    .stat-value { font-size: 40px; font-weight: 800; line-height: 1; }
    .stat-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }

    /* Zone Tabs */
    .zone-tabs {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
        padding: 4px 8px;
    }

    .zone-tab {
        padding: 8px 4px;
        border: 2px solid var(--gray-500);
        border-radius: 8px;
        background: transparent;
        color: var(--gray-400);
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        text-align: center;
    }

    .zone-tab.active {
        border-color: var(--amazon-orange);
        background: var(--amazon-orange);
        color: var(--amazon-dark);
    }

    .zone-tab .tab-count { display: block; font-size: 18px; font-weight: 800; }

    /* Package List - Scrollable area */
    .package-list-container {
        flex: 1;
        min-height: 0;
        padding: 4px 8px;
        overflow: hidden;
    }

    .package-list {
        height: 100%;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        display: flex;
        flex-wrap: wrap;
        align-content: flex-start;
        gap: 8px;
        padding-bottom: 4px;
    }

    .package-chip {
        height: 52px;
        min-width: 70px;
        padding: 0 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        background: var(--amazon-squid);
        border: 3px solid var(--gray-500);
        font-size: 24px;
        font-weight: 800;
        color: var(--white);
    }

    .package-chip:active { transform: scale(0.95); }

    .package-chip.selected {
        border-color: var(--amazon-orange);
        background: rgba(255, 153, 0, 0.25);
        color: var(--amazon-orange);
    }

    .empty-zone {
        width: 100%;
        text-align: center;
        padding: 24px;
        color: var(--gray-500);
        font-size: 15px;
    }

    /* Selection Bar */
    .selection-bar {
        padding: 10px 8px;
        background: var(--amazon-squid);
        border-top: 3px solid var(--amazon-orange);
        display: none;
    }

    .selection-bar.active { display: block; }

    .selection-info {
        text-align: center;
        font-size: 13px;
        color: var(--gray-400);
        margin-bottom: 8px;
    }

    .selection-info strong { color: var(--amazon-orange); font-size: 16px; }

    .selection-actions {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .selection-main {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
    }

    .selection-btn {
        border: none;
        border-radius: 10px;
        font-weight: 800;
        text-transform: uppercase;
    }

    .selection-btn.deliver {
        padding: 22px;
        background: var(--success);
        color: var(--white);
        font-size: 20px;
    }

    .selection-btn.cancel {
        padding: 22px;
        background: var(--error);
        color: var(--white);
        font-size: 18px;
    }

    .selection-moves {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
    }

    .selection-btn.move {
        padding: 10px 4px;
        background: transparent;
        color: var(--gray-400);
        border: 2px solid var(--gray-500);
        font-size: 11px;
        border-radius: 8px;
    }

    .selection-btn.move:active {
        background: var(--amazon-orange);
        border-color: var(--amazon-orange);
        color: var(--amazon-dark);
    }

    /* Delivery Bottom */
    .delivery-bottom { padding: 6px 8px; }

    .delivery-actions {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
    }

    .delivery-btn {
        padding: 12px;
        border: none;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 800;
        text-transform: uppercase;
    }

    .delivery-btn.add { background: var(--amazon-orange); color: var(--amazon-dark); }
    .delivery-btn.reset { background: var(--amazon-squid); color: var(--gray-400); border: 2px solid var(--gray-500); }

    /* Modal */
    .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.92);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 20px;
    }

    .modal-overlay.active { display: flex; }

    .modal {
        width: 100%;
        max-width: 340px;
        background: var(--amazon-squid);
        border-radius: 16px;
        overflow: hidden;
        border: 3px solid var(--amazon-orange);
    }

    .modal-header {
        padding: 20px;
        background: var(--amazon-orange);
        text-align: center;
    }

    .modal-number { font-size: 64px; font-weight: 800; color: var(--amazon-dark); }
    .modal-body { padding: 20px; }
    .modal-message { text-align: center; font-size: 16px; color: var(--gray-400); margin-bottom: 16px; }

    .modal-current {
        background: var(--amazon-dark);
        padding: 14px;
        border-radius: 10px;
        text-align: center;
        margin-bottom: 18px;
    }

    .modal-current-label { font-size: 11px; color: var(--gray-500); text-transform: uppercase; margin-bottom: 4px; }
    .modal-current-zone { font-size: 22px; font-weight: 800; color: var(--white); }

    .modal-buttons { display: flex; flex-direction: column; gap: 10px; }

    .modal-btn {
        padding: 16px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 800;
        text-transform: uppercase;
    }

    .modal-btn.confirm { background: var(--amazon-orange); color: var(--amazon-dark); }
    .modal-btn.cancel { background: var(--amazon-dark); color: var(--gray-400); }

    /* Toast */
    .toast {
        position: fixed;
        top: calc(var(--safe-top) + 60px);
        left: 50%;
        transform: translateX(-50%) translateY(-20px);
        background: var(--success);
        color: var(--white);
        padding: 12px 24px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 700;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 2000;
        pointer-events: none;
    }

    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    .toast.error { background: var(--error); }

    /* Celebration */
    .celebration {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .celebration-emoji { font-size: 80px; animation: bounce 0.6s ease infinite; }
    @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-16px); } }
    .celebration-text { font-size: 32px; font-weight: 800; margin-top: 16px; }
    .celebration-sub { font-size: 18px; color: var(--amazon-orange); margin-top: 8px; }

    /* Quick Add */
    .quick-add-overlay {
        position: fixed;
        inset: 0;
        background: var(--amazon-dark);
        display: none;
        flex-direction: column;
        z-index: 1000;
        padding-top: var(--safe-top);
        padding-bottom: var(--safe-bottom);
    }

    .quick-add-overlay.active { display: flex; }

    .quick-add-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: var(--amazon-squid);
        border-bottom: 3px solid var(--amazon-orange);
    }

    .quick-add-title { font-size: 18px; font-weight: 700; }

    .quick-add-close {
        width: 44px;
        height: 44px;
        border: none;
        border-radius: 50%;
        background: var(--error);
        color: var(--white);
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
</style>
```

</head>
<body>
    <div id="app"></div>
    <div class="toast" id="toast"></div>

```
<div class="modal-overlay" id="confirmModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-number" id="modalNumber">01</div>
        </div>
        <div class="modal-body">
            <div class="modal-message">Already loaded</div>
            <div class="modal-current">
                <div class="modal-current-label">Currently in</div>
                <div class="modal-current-zone" id="modalCurrentZone">Front</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" id="modalConfirm">Move to <span id="modalNewZone">Back</span></button>
                <button class="modal-btn cancel" id="modalCancel">Keep Current</button>
            </div>
        </div>
    </div>
</div>

<div class="quick-add-overlay" id="quickAddOverlay">
    <div class="quick-add-header">
        <span class="quick-add-title">Quick Add</span>
        <button class="quick-add-close" id="quickAddClose">‚úï</button>
    </div>
    <div id="quickAddContent" style="flex:1;display:flex;flex-direction:column;"></div>
</div>

<script>
    // Prevent ALL scrolling/bouncing
    document.addEventListener('touchmove', e => e.preventDefault(), { passive: false });
    document.addEventListener('gesturestart', e => e.preventDefault());
    document.addEventListener('gesturechange', e => e.preventDefault());

    let packages = JSON.parse(localStorage.getItem('fr2_packages') || '{}');
    let delivered = JSON.parse(localStorage.getItem('fr2_delivered') || '[]');
    let view = 'loading';
    let currentNumber = '';
    let selectedPackages = [];
    let activeZone = 'front';
    let pendingMove = null;
    let quickAddNumber = '';

    const zones = { front: 'Front', back: 'Back', trunk: 'Trunk' };

    // Audio
    const Audio = {
        ctx: null,
        init() {
            if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)();
            if (this.ctx.state === 'suspended') this.ctx.resume();
        },
        keyClick() {
            this.init();
            const now = this.ctx.currentTime;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            const filter = this.ctx.createBiquadFilter();
            filter.type = 'bandpass'; filter.frequency.value = 3200; filter.Q.value = 0.8;
            osc.connect(filter); filter.connect(gain); gain.connect(this.ctx.destination);
            osc.type = 'square';
            osc.frequency.setValueAtTime(2000, now);
            osc.frequency.exponentialRampToValueAtTime(800, now + 0.025);
            gain.gain.setValueAtTime(0.12, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.04);
            osc.start(now); osc.stop(now + 0.04);
            const osc2 = this.ctx.createOscillator();
            const gain2 = this.ctx.createGain();
            osc2.connect(gain2); gain2.connect(this.ctx.destination);
            osc2.type = 'sine';
            osc2.frequency.setValueAtTime(180, now);
            osc2.frequency.exponentialRampToValueAtTime(60, now + 0.05);
            gain2.gain.setValueAtTime(0.08, now);
            gain2.gain.exponentialRampToValueAtTime(0.001, now + 0.06);
            osc2.start(now); osc2.stop(now + 0.06);
        },
        success() {
            this.init();
            const now = this.ctx.currentTime;
            const osc1 = this.ctx.createOscillator();
            const gain1 = this.ctx.createGain();
            osc1.connect(gain1); gain1.connect(this.ctx.destination);
            osc1.type = 'sine'; osc1.frequency.value = 880;
            gain1.gain.setValueAtTime(0, now);
            gain1.gain.linearRampToValueAtTime(0.22, now + 0.01);
            gain1.gain.setValueAtTime(0.22, now + 0.07);
            gain1.gain.exponentialRampToValueAtTime(0.001, now + 0.11);
            osc1.start(now); osc1.stop(now + 0.11);
            const osc2 = this.ctx.createOscillator();
            const gain2 = this.ctx.createGain();
            osc2.connect(gain2); gain2.connect(this.ctx.destination);
            osc2.type = 'sine'; osc2.frequency.value = 1174.66;
            gain2.gain.setValueAtTime(0, now + 0.09);
            gain2.gain.linearRampToValueAtTime(0.28, now + 0.1);
            gain2.gain.setValueAtTime(0.28, now + 0.2);
            gain2.gain.exponentialRampToValueAtTime(0.001, now + 0.32);
            osc2.start(now + 0.09); osc2.stop(now + 0.32);
        },
        delivered() {
            this.init();
            const now = this.ctx.currentTime;
            [1318.51, 1567.98, 2093.00].forEach((freq, i) => {
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.connect(gain); gain.connect(this.ctx.destination);
                osc.type = 'sine'; osc.frequency.value = freq;
                const t = now + (i * 0.07);
                gain.gain.setValueAtTime(0, t);
                gain.gain.linearRampToValueAtTime(0.18, t + 0.02);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.28);
                osc.start(t); osc.stop(t + 0.28);
            });
        },
        error() {
            this.init();
            const now = this.ctx.currentTime;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.connect(gain); gain.connect(this.ctx.destination);
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, now);
            osc.frequency.exponentialRampToValueAtTime(150, now + 0.18);
            gain.gain.setValueAtTime(0.12, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.22);
            osc.start(now); osc.stop(now + 0.22);
        },
        tap() {
            this.init();
            const now = this.ctx.currentTime;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.connect(gain); gain.connect(this.ctx.destination);
            osc.type = 'sine'; osc.frequency.value = 1400;
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.06);
            osc.start(now); osc.stop(now + 0.06);
        }
    };

    function haptic(style = 'light') {
        if ('vibrate' in navigator) {
            const p = { light: [8], medium: [15], success: [10, 30, 10], error: [40, 20, 40] };
            navigator.vibrate(p[style] || [8]);
        }
    }

    function save() {
        localStorage.setItem('fr2_packages', JSON.stringify(packages));
        localStorage.setItem('fr2_delivered', JSON.stringify(delivered));
    }

    function showToast(msg, isError = false) {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.className = 'toast' + (isError ? ' error' : '');
        setTimeout(() => t.classList.add('show'), 10);
        setTimeout(() => t.classList.remove('show'), 1800);
    }

    function formatNumber(num) {
        const n = String(parseInt(num, 10) || 0);
        return n.length === 1 ? '0' + n : n;
    }

    function normalizeKey(num) { return String(parseInt(num, 10) || 0); }
    function getZoneCount(zone) { return Object.entries(packages).filter(([n, z]) => z === zone && !delivered.includes(n)).length; }
    function getTotalRemaining() { return Object.keys(packages).filter(n => !delivered.includes(n)).length; }
    function getTotalDelivered() { return delivered.length; }
    function getZonePackages(zone) { return Object.entries(packages).filter(([n, z]) => z === zone && !delivered.includes(n)).map(([n]) => n).sort((a, b) => parseInt(a) - parseInt(b)); }

    function handleDigit(d) { Audio.keyClick(); haptic('light'); if (currentNumber.length >= 3) currentNumber = d; else currentNumber += d; render(); }
    function handleClear() { Audio.keyClick(); haptic('light'); currentNumber = ''; render(); }
    function handleBackspace() { Audio.keyClick(); haptic('light'); currentNumber = currentNumber.slice(0, -1); render(); }

    function handleZone(zone) {
        if (!currentNumber) return;
        const key = normalizeKey(currentNumber);
        if (packages[key]) {
            if (packages[key] === zone) {
                Audio.error(); haptic('error');
                showToast(`#${formatNumber(key)} already in ${zones[zone]}`, true);
                currentNumber = ''; render(); return;
            }
            pendingMove = { key, zone };
            showConfirmModal(); return;
        }
        addPackage(key, zone);
    }

    function addPackage(key, zone) {
        packages[key] = zone;
        delivered = delivered.filter(n => n !== key);
        Audio.success(); haptic('success');
        showToast(`#${formatNumber(key)} ‚Üí ${zones[zone]}`);
        currentNumber = ''; save(); render();
    }

    function showConfirmModal() {
        document.getElementById('modalNumber').textContent = formatNumber(pendingMove.key);
        document.getElementById('modalCurrentZone').textContent = zones[packages[pendingMove.key]];
        document.getElementById('modalNewZone').textContent = zones[pendingMove.zone];
        document.getElementById('confirmModal').classList.add('active');
    }

    function hideConfirmModal() { document.getElementById('confirmModal').classList.remove('active'); pendingMove = null; }

    document.getElementById('modalConfirm').addEventListener('click', () => {
        if (pendingMove) {
            Audio.success(); haptic('success');
            packages[pendingMove.key] = pendingMove.zone;
            delivered = delivered.filter(n => n !== pendingMove.key);
            showToast(`#${formatNumber(pendingMove.key)} ‚Üí ${zones[pendingMove.zone]}`);
            currentNumber = ''; save();
        }
        hideConfirmModal(); render();
    });

    document.getElementById('modalCancel').addEventListener('click', () => { Audio.keyClick(); haptic('light'); currentNumber = ''; hideConfirmModal(); render(); });

    function togglePackage(key) {
        Audio.tap(); haptic('light');
        if (selectedPackages.includes(key)) selectedPackages = selectedPackages.filter(k => k !== key);
        else selectedPackages.push(key);
        render();
    }

    function markDelivered() {
        Audio.delivered(); haptic('success');
        selectedPackages.forEach(key => { if (!delivered.includes(key)) delivered.push(key); });
        showToast(`${selectedPackages.length} delivered!`);
        selectedPackages = []; save(); render();
    }

    function moveSelectedTo(zone) {
        Audio.success(); haptic('success');
        selectedPackages.forEach(key => { packages[key] = zone; });
        showToast(`${selectedPackages.length} ‚Üí ${zones[zone]}`);
        selectedPackages = []; save(); render();
    }

    function clearSelection() { Audio.keyClick(); haptic('light'); selectedPackages = []; render(); }

    function showQuickAdd() {
        Audio.keyClick(); haptic('light');
        quickAddNumber = '';
        document.getElementById('quickAddOverlay').classList.add('active');
        renderQuickAdd();
    }

    function hideQuickAdd() { document.getElementById('quickAddOverlay').classList.remove('active'); }

    function renderQuickAdd() {
        const c = document.getElementById('quickAddContent');
        const exists = quickAddNumber && packages[normalizeKey(quickAddNumber)];
        const displayNum = quickAddNumber ? formatNumber(quickAddNumber) : '--';
        c.innerHTML = `
            <div class="number-display"><div class="current-number ${quickAddNumber ? (exists ? 'exists' : '') : 'empty'}">${displayNum}</div><div class="number-hint ${exists ? 'exists' : ''}">${exists ? `Already in ${zones[packages[normalizeKey(quickAddNumber)]]}` : (quickAddNumber ? 'Select zone' : 'Enter number')}</div></div>
            <div class="numpad">${[1,2,3,4,5,6,7,8,9].map(d => `<button class="numpad-btn" data-qa="${d}">${d}</button>`).join('')}<button class="numpad-btn clear" data-qa-clear>C</button><button class="numpad-btn" data-qa="0">0</button><button class="numpad-btn backspace" data-qa-back>‚å´</button></div>
            <div class="zone-buttons">${Object.entries(zones).map(([k, n]) => `<button class="zone-btn ${!quickAddNumber ? 'disabled' : ''}" data-qa-zone="${k}">${n}</button>`).join('')}</div>
        `;
        c.querySelectorAll('[data-qa]').forEach(b => b.addEventListener('click', () => { Audio.keyClick(); haptic('light'); if (quickAddNumber.length < 3) quickAddNumber += b.dataset.qa; else quickAddNumber = b.dataset.qa; renderQuickAdd(); }));
        c.querySelector('[data-qa-clear]')?.addEventListener('click', () => { Audio.keyClick(); haptic('light'); quickAddNumber = ''; renderQuickAdd(); });
        c.querySelector('[data-qa-back]')?.addEventListener('click', () => { Audio.keyClick(); haptic('light'); quickAddNumber = quickAddNumber.slice(0, -1); renderQuickAdd(); });
        c.querySelectorAll('[data-qa-zone]').forEach(b => b.addEventListener('click', () => {
            if (!quickAddNumber) return;
            const zone = b.dataset.qaZone, key = normalizeKey(quickAddNumber);
            if (packages[key] && packages[key] === zone) { Audio.error(); haptic('error'); showToast(`#${formatNumber(key)} already in ${zones[zone]}`, true); }
            else { packages[key] = zone; delivered = delivered.filter(n => n !== key); Audio.success(); haptic('success'); showToast(`#${formatNumber(key)} ‚Üí ${zones[zone]}`); save(); }
            quickAddNumber = ''; renderQuickAdd(); render();
        }));
    }

    document.getElementById('quickAddClose').addEventListener('click', hideQuickAdd);

    function render() {
        document.getElementById('app').innerHTML = view === 'delivery' ? renderDelivery() : renderLoading();
        attachListeners();
    }

    function renderLoading() {
        const exists = currentNumber && packages[normalizeKey(currentNumber)];
        const displayNum = currentNumber ? formatNumber(currentNumber) : '--';
        return `<div class="app">
            <div class="header"><div class="logo">Flex<span>Runner</span></div><div class="zone-counts"><div class="zone-count"><span class="zone-count-num">${getZoneCount('front')}</span>Front</div><div class="zone-count"><span class="zone-count-num">${getZoneCount('back')}</span>Back</div><div class="zone-count"><span class="zone-count-num">${getZoneCount('trunk')}</span>Trunk</div></div></div>
            <div class="number-display"><div class="current-number ${currentNumber ? (exists ? 'exists' : '') : 'empty'}">${displayNum}</div><div class="number-hint ${exists ? 'exists' : ''}">${exists ? `Already in ${zones[packages[normalizeKey(currentNumber)]]}` : (currentNumber ? 'Select zone' : 'Enter package number')}</div></div>
            <div class="numpad">${[1,2,3,4,5,6,7,8,9].map(d => `<button class="numpad-btn" data-digit="${d}">${d}</button>`).join('')}<button class="numpad-btn clear" data-clear>C</button><button class="numpad-btn" data-digit="0">0</button><button class="numpad-btn backspace" data-back>‚å´</button></div>
            <div class="zone-buttons">${Object.entries(zones).map(([k, n]) => `<button class="zone-btn ${!currentNumber ? 'disabled' : ''}" data-zone="${k}">${n}</button>`).join('')}</div>
            <div class="bottom-cta"><button class="cta-btn" id="startBtn" ${getTotalRemaining() === 0 ? 'disabled' : ''}>üöö Deliver (${getTotalRemaining()})</button></div>
        </div>`;
    }

    function renderDelivery() {
        const totalD = getTotalDelivered(), totalR = getTotalRemaining();
        const allDone = totalR === 0 && Object.keys(packages).length > 0;
        const zp = getZonePackages(activeZone), hasSel = selectedPackages.length > 0;
        return `<div class="delivery-app">
            <div class="delivery-header"><div class="delivery-title">Deliver<span>ing</span></div><button class="back-btn" id="backBtn">‚Üê Back</button></div>
            <div class="delivery-stats"><div class="stat-box delivered"><div class="stat-value">${totalD}</div><div class="stat-label">Delivered</div></div><div class="stat-box remaining"><div class="stat-value">${totalR}</div><div class="stat-label">Remaining</div></div></div>
            <div class="zone-tabs">${Object.entries(zones).map(([k, n]) => `<button class="zone-tab ${activeZone === k ? 'active' : ''}" data-tab="${k}"><span class="tab-count">${getZoneCount(k)}</span>${n}</button>`).join('')}</div>
            <div class="package-list-container">${allDone ? `<div class="celebration"><div class="celebration-emoji">üéâ</div><div class="celebration-text">All Done!</div><div class="celebration-sub">Route complete</div></div>` : `<div class="package-list">${zp.length === 0 ? `<div class="empty-zone">No packages in ${zones[activeZone]}</div>` : zp.map(key => `<div class="package-chip ${selectedPackages.includes(key) ? 'selected' : ''}" data-pkg="${key}">${formatNumber(key)}</div>`).join('')}</div>`}</div>
            <div class="selection-bar ${hasSel ? 'active' : ''}"><div class="selection-info"><strong>${selectedPackages.length}</strong> selected</div><div class="selection-actions"><div class="selection-main"><button class="selection-btn deliver" id="deliverBtn">‚úì Delivered</button><button class="selection-btn cancel" id="cancelBtn">‚úï Cancel</button></div><div class="selection-moves"><button class="selection-btn move" data-move="front">‚Üí Front</button><button class="selection-btn move" data-move="back">‚Üí Back</button><button class="selection-btn move" data-move="trunk">‚Üí Trunk</button></div></div></div>
            <div class="delivery-bottom" ${hasSel ? 'style="display:none"' : ''}><div class="delivery-actions"><button class="delivery-btn add" id="addBtn">+ Add</button><button class="delivery-btn reset" id="resetBtn">Reset</button></div></div>
        </div>`;
    }

    function attachListeners() {
        document.querySelectorAll('[data-digit]').forEach(b => b.addEventListener('click', () => handleDigit(b.dataset.digit)));
        document.querySelector('[data-clear]')?.addEventListener('click', handleClear);
        document.querySelector('[data-back]')?.addEventListener('click', handleBackspace);
        document.querySelectorAll('[data-zone]').forEach(b => b.addEventListener('click', () => handleZone(b.dataset.zone)));
        document.getElementById('startBtn')?.addEventListener('click', () => { if (getTotalRemaining() === 0) return; Audio.tap(); haptic('medium'); view = 'delivery'; selectedPackages = []; render(); });
        document.getElementById('backBtn')?.addEventListener('click', () => { Audio.keyClick(); haptic('light'); view = 'loading'; selectedPackages = []; render(); });
        document.querySelectorAll('[data-tab]').forEach(b => b.addEventListener('click', () => { Audio.tap(); haptic('light'); activeZone = b.dataset.tab; selectedPackages = []; render(); }));
        document.querySelectorAll('[data-pkg]').forEach(c => c.addEventListener('click', () => togglePackage(c.dataset.pkg)));
        document.querySelectorAll('[data-move]').forEach(b => b.addEventListener('click', () => moveSelectedTo(b.dataset.move)));
        document.getElementById('deliverBtn')?.addEventListener('click', markDelivered);
        document.getElementById('cancelBtn')?.addEventListener('click', clearSelection);
        document.getElementById('addBtn')?.addEventListener('click', showQuickAdd);
        document.getElementById('resetBtn')?.addEventListener('click', () => { if (confirm('Reset all delivery progress?')) { Audio.keyClick(); haptic('medium'); delivered = []; save(); render(); } });
    }

    render();
</script>
```

</body>
</html>